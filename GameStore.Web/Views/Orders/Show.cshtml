@using GameStore.Common.Enums
@model GameStore.Web.Models.OrderViewModel

@{
	ViewBag.Title = "Order";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Order</h1>
<hr />
<b>@Html.LabelFor(m => m.Id)</b>
<p>@Html.DisplayFor(m => m.Id)</p>

@if (Model.User != null)
{
	<b>@Html.LabelFor(m => m.User.Login)</b>
	<p>@Html.DisplayFor(m => m.User.Login)</p>
}

@if (Model.DateOrdered != null)
{
	<b>@Html.LabelFor(m => m.DateOrdered)</b>
	<p>@Html.DisplayFor(m => m.DateOrdered)</p>
}

@if (Model.DateShipped != null)
{
	<b>@Html.LabelFor(m => m.DateShipped)</b>
	<p>@Html.DisplayFor(m => m.DateShipped)</p>
}

<b>@Html.LabelFor(m => m.OrderStatus)</b>
<p>@Html.DisplayFor(m => m.OrderStatus)</p>
<b>@Html.LabelFor(m => m.TotalPrice)</b>
<p>@Html.DisplayFor(m => m.TotalPrice)</p>

@if (Model.OrderDetails.Count != 0)
{
	<h3>Order details</h3>

	foreach (var detail in Model.OrderDetails)
	{
		<b>@Html.LabelFor(m => detail.Game.Name)</b>
		<p>
			@Html.DisplayFor(m => detail.Game.Name)
		</p>
		<b>@Html.LabelFor(m => detail.Price)</b>
		<p>
			@Html.DisplayFor(m => detail.Price)
		</p>
		<b>@Html.LabelFor(m => detail.Quantity)</b>
		<p>
			@Html.DisplayFor(m => detail.Quantity)
		</p>

		if (Model.OrderStatus != OrderStatus.Shipped)
		{
			using (Html.BeginForm("AddDetails", "Orders", FormMethod.Post))
			{
				<input type="hidden" name="orderId" value=@Model.Id />
				<input type="hidden" name="gameKey" value=@detail.GameKey />
				<button type="submit" class="btn btn-default">Add unit</button>
			}

			using (Html.BeginForm("DeleteDetails", "Orders", FormMethod.Post))
			{
				<input type="hidden" name="orderId" value=@Model.Id />
				<input type="hidden" name="gameKey" value=@detail.GameKey />
				<button type="submit" class="btn btn-default">Delete unit</button>
			}
		}

		<hr />
	}

	if (Model.OrderStatus != OrderStatus.Shipped)
	{
		using (Html.BeginForm("Ship", "Orders", FormMethod.Post))
		{
			<input type="hidden" name="orderId" value=@Model.Id />
			<button type="submit" class="btn btn-default">Ship</button>
		}
	}
}