@model GameStore.Web.Models.CompositeOrdersViewModel

@{
	ViewBag.Title = "History";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>History</h1>
<hr />

@using (Html.BeginForm("History", "Orders", FormMethod.Post))
{
	<b>@Html.LabelFor(m => m.Filter.From)</b>
	<p>
		@Html.TextBoxFor(m => m.Filter.From, new { @class = "form-control", type = "date" })
		@Html.ValidationMessageFor(m => m.Filter.From)
	</p>
	<b>@Html.LabelFor(m => m.Filter.To)</b>
	<p>
		@Html.TextBoxFor(m => m.Filter.To, new { @class = "form-control", type = "date" })
		@Html.ValidationMessageFor(m => m.Filter.To)
	</p>

	<p><button type="submit" class="btn btn-default">Filter</button></p>
}

<hr/>
@if (Model.Orders.Count != 0)
{
	if (Model.Orders.Count > 0)
	{
		foreach (var order in Model.Orders)
		{
			<b>@Html.LabelFor(m => order.DateOrdered)</b>
			<p>@Html.DisplayFor(m => order.DateOrdered)</p>

			if (order.OrderDetails.Count != 0)
			{
				<h3>Order details:</h3>

				foreach (var detail in order.OrderDetails)
				{
					<b>@Html.LabelFor(m => detail.Game.Name)</b>
					<p>
						@Html.DisplayFor(m => detail.Game.Name)
					</p>
					<b>@Html.LabelFor(m => detail.Price)</b>
					<p>
						@Html.DisplayFor(m => detail.Price)
					</p>
					<b>@Html.LabelFor(m => detail.Quantity)</b>
					<p>
						@Html.DisplayFor(m => detail.Quantity)
					</p>
					<hr/>
				}
			}
			<hr />
		}
	}
}
else
{
	<p>There are no orders that match your filter</p>
}